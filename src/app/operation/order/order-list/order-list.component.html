<div class="row">
  <div class="col-md-12">
    <div class="card">
      <div class="card-body">
        <div class="card-title">
          <h3 i18n>LISTS ORDERS</h3>
        </div>
        <form [formGroup]="searchForm" class="row search-form">
          <div class="col-md-6 col-sm-12 form-group m-b-10">
            <label for="keyWordGroup" class="form-control-label" i18n>Keyword</label>
            <div class="row input-group input-group-sm ml-0 mr-0" id="keyWordGroup">
              <select class="col-sm-5 form-control form-control-sm input-group-addon" name="searchKeyword"
                      id="searchKeyword" formControlName="searchKeyword">
                <option value="ALL" i18n>ALL Keyword</option>
                <option *ngFor="let item of searchKeys" [value]="item.key">{{item.name}}</option>
              </select>
              <input class="form-control form-control-sm" id="keyWord" (keyup.enter)="listOrders()" formControlName="keyWord"
                     type="text">
            </div>
          </div>
          <div class="col-md-6 col-sm-12 form-group m-b-10">
            <label for="dateTimePicker" class="form-control-label" i18n>Time Search</label>
            <div class="row input-group input-group-sm ml-0 mr-0" id="dateTimePicker">
              <select class="col-sm-5 form-control form-control-sm input-group-addon" name="currentStatus" id="timeKey"
                      formControlName="timeKey">
                <option [value]="allKey" i18n>Time Key</option>
                <option value="{{time.key}}" *ngFor="let time of timeKeys">{{time.name}}</option>
              </select>
              <input #drp="bsDaterangepicker"
                     (keyup.enter)="listOrders()"
                     bsDaterangepicker
                     [bsConfig]="{dateInputFormat: 'DD-MM-YYYY'}"
                     (bsValueChange)="bsRangeValue"
                     formControlName="bsRangeValue"
                     class="col-sm-7 form-control form-control-sm ">
              <span class="input-group-btn">
                                        <button (click)="drp.toggle()"
                                                [attr.aria-expanded]="drp.isOpen"
                                                class="btn btn-sm btn-info" type="button"><i
                                          class="fa fa-calendar"></i>
                                        </button>
                                    </span>
            </div>
          </div>
          <div class="col-md-3 col-sm-12  form-group m-b-10">
            <label for="store" class="form-control-label" i18n>Store</label>
            <select class="form-control form-control-sm" (change)="prepareSearch()" name="store" id="store"
                    formControlName="store">
              <option [value]="allKey" i18n>All Weshop</option>
              <option [value]="1" i18n>Weshop VN</option>
              <option [value]="7" i18n>Weshop ID</option>
            </select>
          </div>
          <div class="col-md-3 col-sm-6 form-group m-b-10">
            <label for="type" class="form-control-label" i18n>Order Type</label>
            <select class="form-control form-control-sm" name="type" id="type" formControlName="type">
              <option [value]="allKey" i18n>--All Type--</option>
              <option value="SHOP" i18n>Shop</option>
              <option value="REQUEST" i18n>Request</option>
              <option value="SHIP" i18n>Ship</option>
            </select>
          </div>
          <div class="col-md-3 col-sm-6 form-group m-b-10">
            <label class="form-control-label" i18n>Order Status</label>
            <select class="form-control form-control-sm" name="orderStatus" id="orderStatus"
                    formControlName="orderStatus">
              <option [value]="allKey" i18n>--All Status--</option>
              <option [value]="status.key" *ngFor="let status of orderStatus">{{status.name}}</option>
            </select>
          </div>
          <div class="col-md-3 col-sm-6 form-group m-b-10">
            <label class="form-control-label" i18n>Payment Request</label>
            <select class="form-control form-control-sm" name="status" id="location" formControlName="paymentRequest">
              <option [value]="allKey" i18n>--All Paymnet Request--</option>
              <option [value]="payment.key" *ngFor="let payment of paymentRequests">{{payment.name}}
            </select>
          </div>
          <div class="col-md-3 col-sm-6 form-group m-b-10">
            <label class="form-control-label" i18n>Product Type</label>
            <select class="form-control form-control-sm" name="portal" id="portal" formControlName="portal">
              <option [value]="allKey" i18n >--All Product Type--</option>
              <option value="AMAZON_US" >AMAZON US</option>
              <option value="AMAZON_JAPAN" >AMAZON JAPAN</option>
              <option value="OTHER" >OTHER</option>
              <option value="EBAY" >EBAY</option>
              <option value="AMAZON_JP" >AMAZON JP</option>
            </select>
          </div>
          <div class="col-md-3 col-sm-6 form-group m-b-10">
            <label for="paymentStatus" class="form-control-label" i18n>Payment Status</label>
            <select class="form-control form-control-sm" name="store" id="paymentStatus"
                    formControlName="paymentStatus">
              <option [value]="allKey" i18n >--All Payment Status--</option>
              <option value="PAID">PAID</option>
              <option value="UNPAID">UNPAID</option>
              <!--option value="SELLER_SHIPPED">REFUND PRTIAL</option-->
              <!--<option value="REFUND_FULL">REFUND FULL</option>-->
            </select>
          </div>
          <div class="col-md-3 col-sm-6 form-group m-b-10">
            <label class="form-control-label" i18n>Sale</label>
            <select class="form-control form-control-sm" name="sale" id="sale" formControlName="sale">
              <option [value]="allKey" i18n >--All Sale--</option>
              <option value="{{sale.id}}" *ngFor="let sale of listSale">{{sale ? sale.username : ""}}</option>
            </select>
          </div>
          <div class="col-md-3 col-sm-6 form-group m-b-10" *ngIf="_scope.checkRoleOption()">
            <label class="form-control-label">No Tracking</label>
            <select class="form-control form-control-sm" name="noTracking" id="noTracking" formControlName="noTracking">
            <option [value]="allKey" i18n>--TracKing--</option>
            <option value="NO_TRACKING">No Tracking</option>
            <option value="STOCKIN_US2DAY">2 ngày kho nhập nhưng không xuất hàng về</option>
            <option value="PURCHASED2DAY">2 ngày đã mua người bán chưa gửi hàng</option>
            <option value="10STOCKOUT_US">10 ngày hàng nhập kho Mỹ nhưng không có danh sách về Việt Nam</option>
            <option value="SHIPPED5">5 ngày người bán gửi hàng mà chưa thấy nhập kho</option>
            </select>
          </div>
          <!--<div class="col-md-3 col-sm-6 form-group m-b-10">-->
            <!--<label class="form-control-label" i18n>Service</label>-->
            <!--<select class="form-control form-control-sm" name="seller" id="policy" formControlName="policy">-->
              <!--<option [value]="allKey" i18n>&#45;&#45;All Service&#45;&#45;</option>-->
              <!--<option value=""></option>-->
              <!--<option value=""></option>-->
              <!--<option value=""></option>-->
              <!--<option value=""></option>-->
            <!--</select>-->
          <!--</div>-->
          <div class="col-md-12 mt-1">
            <div class="button-group">
                <button class="btn btn-sm btn-success" (click)="listOrders()"><i class="fa fa-search"></i><span i18n>Search</span></button>
                <button class="btn btn-sm btn-danger ml-2" (click)="freshOrder()"><i class="fa fa-refresh mr-1" aria-hidden="true"></i><span i18n>Refresh</span></button>
                <button class="btn btn-info btn-sm text-white ml-1" i18n><i class="fa fa-file-excel-o"></i> Export Excel</button>
              <!--<button type="button" class="btn btn-warning btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-->
                <!--<i class="fa fa-plus mr-1"></i>Add Filter-->
              <!--</button>-->
              <!--<div class="dropdown-menu p-0" style="font-size: 11px">-->
                <!--<a class="dropdown-item p-1" href="javascript:void(0);">Đã thanh toán</a>-->
              <!--</div>-->
            </div>
          </div>
          <div class="col-md-6 pt-3">
            <span i18n>Showing </span>
            <select class="form-control-sm select-custom"
                    (change)="handlePerPage($event)">
              <option value="20">20</option>
              <option value="50">50</option>
              <option value="100">100</option>
              <option value="200">200</option>
              <option value="all" i18n>All</option>
            </select>
            <!--span><p i18n>of page</p>{{perPage ? perPage : 0  }}<p i18n>in</p>{{pageCount ? pageCount : 0 }}<p i18n>page in total</p>{{totalCount ? totalCount : 0 }} <p i18n>items</p></span-->
          </div>
          <div class="col-md-6">
            <pagination [boundaryLinks]="true"
                        [totalItems]="totalCount"
                        (pageChanged)="handlePagination($event)"
                        [itemsPerPage]="perPage" class="pagination-sm pull-right"
                        [rotate]="true">
            </pagination>
          </div>
        </form>

        <section class="row item-operation mt-2">
          <div class="col-md-12" *ngIf="_scope.checkRoleOption()">
            <strong>Total: <span class="text-danger mr-1">{{totalOrder}}</span>item</strong> |
            <a href="javascript:void(0)" *ngIf="totalUnPaid > 0" (click)="filterClick('UNPAID')">Chưa thanh toán: <span class="text-danger mr-1">{{totalUnPaid}}</span>item </a>|
            <a href="javascript:void(0)" *ngIf="noTrackingCount > 0" (click)="filterClick('NO_TRACKING')">No Tracking: <span class="text-danger mr-1">{{noTrackingCount}}</span>item </a>|
            <a href="javascript:void(0)" *ngIf="purchase2Day > 0" (click)="filterClick('PURCHASED2DAY')">2 ngày đã mua người bán chưa gửi hàng: <span class="text-danger mr-1">{{purchase2Day}}</span>item</a> |
            <a href="javascript:void(0)" *ngIf="stockin_us > 0" (click)="filterClick('STOCKIN_US2DAY')">2 ngày kho nhập nhưng không xuất hàng về: <span class="text-danger mr-1">{{stockin_us}}</span>item</a> |
            <a href="javascript:void(0)" *ngIf="countPurchase > 0" (click)="filterClick('SHIPPED5')">5 ngày người bán gửi hàng mà chưa thấy nhập kho: <span class="text-danger mr-1">{{countPurchase}}</span>item</a> |
            <a  href="javascript:void(0)" *ngIf="countUS > 0" (click)="filterClick('10STOCKOUT_US')">10 ngày kho Mỹ nhập nhưng không có danh sách về Viêt Nam: <span class="text-danger mr-1">{{countUS}}</span>item</a>
          </div>
        </section>

        <article class="row item-list">
          <div class="col-md-12">
            <div class="row pagination"></div>
            <div class="row grid">
              <div class="col-md-12 pl-0 pr-0">
                <div class="grid-view grid-view-custom">
                  <div class="row" style="font-size: 0.7em">
                    <div class="col-md-12">
                      <div class="card-body" style="padding-left: 0; padding-right: 0;font-size: 11px; color: black">
                        <div class="style-card mb-4" *ngFor="let order of orders">
                          <div class="row margin-row or-id-{{order.id}} order-code-{{order.Ordercode}}">

                            <div class="col-md-3 border-col">
                              <div class="card-title">
                                <h5>
                                  <strong class="text-uppercase">
                                    <a target="_blank"
                                       href="http://weshop.com.vn/order-BIN-{{order.ordercode}}/bill.html">
                                      <span class="text-danger">BIN-{{order.ordercode}}</span>
                                    </a>
                                  </strong> /
                                  <span
                                    class="Paid badge badge-pill badge-{{order.current_status | currentStatus}} badge-Paid text-uppercase p-1 ng-star-inserted">
                                    {{order.current_status}}
                                  </span> /
                                  <span title="OrderItem-paid" *ngIf="paid(order.total_paid_amount_local, order.walletTransactions)" class="Paid badge badge-pill badge-success badge-Paid text-uppercase p-1 ng-star-inserted">Paid</span> <!--check payment transaction-->
                                  <span title="Order-Unpaid" *ngIf="!paid(order.total_paid_amount_local, order.walletTransactions)" class="Unpaid badge badge-pill badge-warning badge-Unpaid text-uppercase p-1 ng-star-inserted">Unpaid</span>
                                </h5>
                              </div>
                              <div class="clearfix"></div>
                              <div class="mt-1">
                                <span><i [class]="order.store_id | iconFlag"></i> </span>
                                <span class="m-l-5 mt-1">{{order.store_id | store}}</span>
                                <span
                                  class="Paid badge badge-pill badge-{{order.type_order | orderTypeClass}} ml-1 badge-Paid text-uppercase p-1 ng-star-inserted">{{order.type_order}}</span>
                              </div>

                              <hr style="margin: 5px;">

                              <div class="mt-1">
                                <ul>
                                  <li class="created_at">
                                    <span><i class="fa fa-clock-o"></i></span> {{order.created_at | date: 'dd/MM/yyyy'}}
                                  </li>
                                  <li class="created_at_timeAgo">
                                    <span style="color: #C1C1C1"><i class="fa fa-clock-o"></i> {{order.created_at | amTimeAgo}}</span>
                                  </li>
                                  <li class="portal OrderType">
                                    <button class="btn btn-default btn-sm">{{order.portal | uppercase }} / Version : {{order.version}}</button>
                                  </li>
                                </ul>
                              </div>

                              <hr style="margin: 5px;">

                              <div class="mt-1">
                                <ul>
                                  <li class="purchase_order_id">
                                    <div class="sty-font purchase_order_id" > <span i18n>Order code </span> {{order.portal | uppercase }} : </div>
                                    {{order.purchase_order_id}}
                                  </li>
                                  <li class="purchase_transaction">
                                    <div class="sty-font purchase_transaction_id"> <span i18n>Transaction </span> {{order.portal | uppercase }} : </div>
                                    {{order.purchase_transaction_id}}
                                  </li>
                                </ul>
                              </div>

                              <hr style="margin: 5px;">

                              <div class="row m-0 p-0 mt-1">
                                <ul class="col-md-11">
                                  <app-assign-sale [orderId]="order.id" [saleAll]="listSale" (checkSale)="loadViewSale($event)" [saleSupport] = "order.saleSupport"></app-assign-sale>
                                </ul>
                                <div class="col-md-1 p-0">
                                  <a href="javascript:void(0)" (click)="filterOneSale(order.sale_support_id)"><i class="fa fa-filter"> </i></a>
                                </div>
                              </div>

                              <hr style="margin: 5px;">

                              <div class=" mt-1  infor_seller">
                                <ul>
                                  <!--<li class="sty-font"><i class="fa fa-link mr-1" i18n></i> Seller Store : <a  href="{{order.seller_store}}">{{order.seller_store}}</a></li>-->
                                  <li class="sty-font" i18n><i class="fa fa-user mr-1" ></i> Seller Name : <a class="ml-1"  href="{{order.seller_store}}" target="_blank">{{order.seller_name}}</a></li>
                                </ul>
                              </div>
                              <hr style="margin: 5px;">

                              <div class=" mt-1" *ngIf="order.purchaseProducts && order.purchaseProducts.length > 0">
                                <div *ngFor="let purchase of order.purchaseProducts">
                                  <i class="fa fa-truck"></i> Warehouse: <b>{{purchase.receive_warehouse_name}}</b>
                                </div>
                              </div>

                              <br>
                            </div>

                            <div class="col-md-3 border-col CUSTOMER_INFO">
                              <h5 class="customer-type-{{order.customer_type}}"   i18n>CUSTOMER INFO</h5>
                              <div class="row">
                                <div class="col-md-12">
                                  <h5 class="text-bold mb-0" i18n>BUYER </h5>
                                  <div *ngIf="_scope.CheckSale()"> <span i18n > CUSTOMER TYPE : </span> <span class="text-bold" >{{order.customer_type | uppercase }} </span> </div>
                                  <span>{{order.customer?.first_name}} - {{order.customer?.phone}} - {{order.customer?.email}}
                                    <a href="javascript:void(0)" (click)="filterOneCustome(order.customer.email)"><i class="fa fa-filter" data-toggle="tooltip" data-placement="top" title="Filter Email BUYER!"> </i></a></span>
                                </div>
                              </div>
                              <hr style="margin: 5px;">
                              <div class="row mt-3">
                                <div class="col-md-12">
                                  <div class="row">
                                    <div class="col-md-12" style="margin-bottom: 2%">
                                      <div>
                                        <h5 style="font-weight: bold; margin-bottom: 0; color: black; font-size: 12px" i18n >RECEIVER
                                          <a href="javascript:void(0)"
                                             (click)="updateCustomer(order);updateReceiverModal.show()" *ngIf = "!_scope.checkMarketingAccount()">
                                            <i class="fa fa-edit" style="color: #00a8ff; margin-left: 2px"></i>
                                          </a>
                                        </h5>
                                      </div>
                                      <div class="address">
                                        <span>{{order.receiver_name}} - {{order.receiver_phone}} - {{order.receiver_email}}</span>
                                        <br>
                                        <span>{{order.receiver_address}} ( {{order.receiver_district_name }} - {{order.receiver_province_name}}) - {{order.receiver_country_name}}</span>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row mt-3">
                                <div class="col-md-12" data-toggle="tooltip" data-placement="top" title="Ghi chú của customer hoặc ghi chú cho người nhận." i18n>
                                  <i class="fa fa-comments"  ></i> Customer note : <strong class="text-danger">{{order.note_by_customer}}</strong>
                                </div>
                                <div class="col-md-12" data-toggle="tooltip" data-placement="top" title="Ghi chú cho đơn hàng !" i18n>
                                  <i class="fa fa-comments"  ></i> Note Orders : <strong class="text-danger">{{order.note}}</strong>
                                </div>
                              </div>

                              <hr>

                              <div class="row col-md-12">
                                  <button type="button" *ngIf="!_scope.checkMarketingAccount()" (click)="chat(order.id, order.ordercode, order.current_status)" class="btn btn-secondary mt-2  btn-sm" data-target="#showChat" data-toggle="modal" data-backdrop="static" data-keyboard="false" i18n>
                                    <i class="fa fa-comments mr-1" aria-hidden="true"></i>
                                    Chat With Customer
                                  </button>
                                  <button (click)="followOrder()" *ngIf="!checkF" type="button" class="btn btn-secondary mt-2 btn-sm" i18n>
                                    <i class="fa fa-bell mr-1"></i> push notifi Track Orders
                                  </button>
                                  <button (click)="followOrder()" *ngIf="checkF" type="button"
                                          class="btn mt-2 btn-secondary btn-sm bo-theo-doi-don-hang">
                                    <i class="fa fa-bell-slash mr-1" aria-hidden="true" i18n></i>
                                    Quit tracking Order
                                  </button>
                              </div>

                              <div class="row col-md-12 pb-1">
                                <button class="btn btn-secondary mt-2 btn-sm" *ngIf="_scope.checkSuperAdmin() || _scope.checkTester()" (click)="viewMoreLog(order.current_status, order.ordercode); ModalviewMoreLog.show()" i18n >More Log</button>
                                <button class="btn btn-secondary mt-2 btn-sm" (click)="confirmAll(order.id)" *ngIf="order.current_status == 'NEW'" i18n >Confirm Orders</button>
                                <button class="btn btn-secondary mt-2 btn-sm" *ngIf="!checkMarkAsJunk(order.current_status, order.total_paid_amount_local) && (_scope.CheckSale() || _scope.checkSale())" (click)="markAsJunk(order.id)" i18n>Mark as Junk</button>
                              </div>


                            </div>


                            <div class="col-md-3 hover-row style-col border-col">
                                <div class="row">
                                  <div class="col-md-7">
                                    <h5 i18n >FINANCE</h5>
                                  </div>
                                  <div class="col-md-5" style="text-align: right">
                                    <button class="btn btn-sm bg-white" tooltip="Show Free" *ngIf="!hideme[order.id]" (click)="hideme[order.id] = !hideme[order.id]" i18n>
                                      <i class="fa fa-eye" aria-hidden="true"></i>
                                    </button>
                                    <button class="btn btn-sm bg-white" tooltip="Hide Free" *ngIf="hideme[order.id]" (click)="hideme[order.id] = !hideme[order.id]" i18n>
                                      <i class="fa fa-eye-slash" aria-hidden="true"></i>
                                    </button>
                                    <a href="javascript:void (0);" ><i class="fa fa-refresh"></i></a>
                                  </div>
                                </div>
                                <div class="row Quantity">
                                  <div class="col-md-7 style-padding-right  dong">
                                    <span i18n >Quantity</span>
                                  </div>
                                  <div class="col-md-5 text-right style-padding-left" *ngIf="order.products">
                                    <span>{{quantityOrder(order.products ,order.products['length'])}}</span>
                                  </div>
                                </div>
                              <hr>
                              <div class="Ws-bold-font row Total_Unit_price_product">
                                <div class="col-md-7 style-padding-right Total_Unit_price_product dong">
                                  <strong><span i18n>Units Price:</span>
                                    ( <span *ngIf="order.portal === 'japan' || order.portal === 'AMAZON_JAPAN' || order.portal === 'JAPAN'">
                                    {{ order.total_price_amount_origin | currency: 'JPY' : '￥'}}
                                    </span>
                                    <span *ngIf="order.portal !== 'japan' && order.portal !== 'AMAZON_JAPAN' && order.portal !== 'JAPAN'">
                                      {{ order.total_price_amount_origin | currency : 'USD' : '$'}}
                                    </span>)
                                  </strong>
                                </div>
                                <div class="col-md-5 text-right style-padding-left dong">
                                    <span>{{order.total_origin_fee_local | number}}
                                  </span>
                                  <span>{{order.store_id | currencyStore}}</span>
                                </div>
                              </div>


                              <div [hidden]="!hideme[order.id]">

                                <div class="row total_origin_tax_fee_local">
                                  <div class="col-md-7 style-padding-right total_fee_amount_local dong">
                                    <span i18n >Total origin tax fee local </span>
                                  </div>
                                  <div class="col-md-5 text-right style-padding-left total_origin_tax_fee_local dong">
                                  <span>
                                    {{order.total_origin_tax_fee_local | number}}
                                  </span>
                                    <span>{{order.store_id | currencyStore}}</span>
                                  </div>
                                </div>

                                <div class="row Total_origin_shiping_fee">
                                  <div class="col-md-7 style-padding-right dong">
                                    <span i18n >Total origin shiping fee</span>
                                  </div>
                                  <div class="col-md-5 text-right style-padding-left dong">
                                  <span>
                                    {{order.total_origin_shipping_fee_local | number}}
                                  </span>
                                    <span>{{order.store_id | currencyStore}}</span>
                                  </div>
                                </div>

                                <hr>
                                <div class="row Total_weshop_fee">
                                  <div class="col-md-7 style-padding-right dong">
                                    <span i18n >Total weshop fee</span>
                                  </div>
                                  <div class="col-md-5 text-right style-padding-left dong">
                                  <span>
                                    {{order.total_weshop_fee_local | number}}
                                  </span>
                                    <span>{{order.store_id | currencyStore}}</span>
                                  </div>
                                </div>

                                <div class="row Total_shiping_fee">
                                  <div class="col-md-7 style-padding-right dong">
                                    <span i18n >Total shiping fee</span>
                                  </div>
                                  <div class="col-md-5 text-right style-padding-left dong">
                                  <span>
                                    {{order.total_intl_shipping_fee_local | number}}
                                  </span>
                                    <span>{{order.store_id | currencyStore}}</span>
                                  </div>
                                </div>
                                <div class="row Total_custom_fee_amount" *ngIf="checkCustomer(order.products)">
                                  <div class="col-md-7 style-padding-right dong">
                                    <span i18n >Total custom fee </span>
                                  </div>
                                  <div class="col-md-5 text-right style-padding-left dong">
                                  <span>
                                    {{order.total_custom_fee_amount_local  | number}}
                                  </span>
                                    <span>{{order.store_id | currencyStore}}</span>
                                  </div>
                                </div>
                                <div class="row Total_delivery_fee">
                                  <div class="col-md-7 style-padding-right dong">
                                    <span i18n >Total delivery fee</span>
                                  </div>
                                  <div class="col-md-5 text-right style-padding-left dong">
                                  <span>
                                    {{order.total_delivery_fee_local  | number}}
                                  </span>
                                    <span>{{order.store_id | currencyStore}}</span>
                                  </div>
                                </div>
                                <div class="row Total_packing_fee">
                                  <div class="col-md-7 style-padding-right dong">
                                    <span i18n >Total packing fee</span>
                                  </div>
                                  <div class="col-md-5 text-right style-padding-left dong">
                                  <span>
                                    {{order.total_packing_fee_local | number}}
                                  </span>
                                    <span>{{order.store_id | currencyStore}}</span>
                                  </div>
                                </div>
                                <div class="row Total_insection_fee">
                                  <div class="col-md-7 style-padding-right dong">
                                    <span i18n >Total inspection fee</span>
                                  </div>
                                  <div class="col-md-5 text-right style-padding-left dong">
                                  <span>
                                    {{order.total_inspection_fee_local | number}}
                                  </span>
                                    <span>{{order.store_id | currencyStore}}</span>
                                  </div>
                                </div>
                                <div class="row Total_insurance_fee">
                                  <div class="col-md-7 style-padding-right dong">
                                    <span i18n >Total insurance fee</span>
                                  </div>
                                  <div class="col-md-5 text-right style-padding-left dong">
                                  <span>
                                    {{order.total_insurance_fee_local | number}}
                                  </span>
                                    <span>{{order.store_id | currencyStore}}</span>
                                  </div>
                                </div>

                                <div class="row Total_VAT_amount">
                                  <div class="col-md-7 style-padding-right dong">
                                    <span i18n >Total VAT amount</span>
                                  </div>
                                  <div class="col-md-5 text-right style-padding-left dong">
                                  <span>
                                    {{order.total_amount_local | number}}
                                  </span>
                                    <span>{{order.store_id | currencyStore}}</span>
                                  </div>
                                </div>
                              </div>

                              <hr style="margin-top: 5px">

                              <div class="Ws-bold-font row Total_fee_order">
                                <div class="col-md-7 style-padding-right dong">
                                  <span i18n >Total Fee Order :</span>
                                </div>
                                <div class="col-md-5 text-right style-padding-left dong">
                                  <!--span>  {{ getTotalOrderFee(order.total_amount_local, order.total_insurance_fee_local, order.total_inspection_fee_local, order.total_packing_fee_local, order.total_delivery_fee_local, order.total_custom_fee_amount_local, order.exchange_rate_fee, order.total_origin_shipping_fee_local, order.total_weshop_fee_local, order.total_origin_tax_fee_local, order.total_fee_amount_local ) | number}}</span-->
                                  <span>{{order.total_fee_amount_local ? order.total_fee_amount_local : 0 }}</span>
                                  <span>{{order.store_id | currencyStore}}</span>
                                </div>
                              </div>

                              <hr>

                              <div class="row Quantity">
                                <div class="col-md-7 style-padding-right  dong">
                                  <span i18n >Exchage rate:</span>
                                </div>
                                <div class="col-md-5 text-right style-padding-left" *ngIf="order.products">
                                  <span> {{order.exchange_rate_fee}} </span>
                                </div>
                              </div>
                              <div class="row exchange_rate_purchase">
                                <div class="col-md-7 style-padding-right  dong">
                                  <span i18n >Exchage rate Purchase:  </span>
                                </div>
                                <div class="col-md-5 text-right style-padding-left Exchage_local">
                                  {{order.exchange_rate_purchase}}
                                </div>
                              </div>

                              <hr>
                              <div class="row total_amount_local">
                                <div class="col-md-7 style-padding-right dong">
                                  <span class="Ws-bold-font" i18n>Total Amout Local</span>
                                </div>
                                <div class="col-md-5 text-right style-padding-left total_final_amount_local">
                                  <span class="Ws-bold-font">
                                    {{order.total_amount_local | number}}
                                  </span>
                                  <span class="Ws-bold-font">{{order.store_id | currencyStore}}</span>
                                </div>
                              </div>

                              <hr>
                              <div class="row Coupon" *ngIf="order.coupon_id && order.coupon?.amount !== ''">
                                <div class="col-md-7 style-padding-right dong">
                                  <span class="Ws-bold-font" i18n>Coupon Code / Amount : </span>
                                </div>
                                <div class="col-md-5 text-right style-padding-left ">
                                  <span class="Ws-bold-font">
                                      <app-span-label [value]="order.coupon?.code"></app-span-label> / {{order.coupon?.amount | number}} <span>{{order.store_id | currencyStore}}</span>
                                  </span>
                                </div>
                              </div>
                              <div class="row Promotion" *ngIf="order.promotion_id && order.promotion?.discountAmount !== null">
                                <div class="col-md-7 style-padding-right dong">
                                  <span class="Ws-bold-font" i18n>Promotion Code/Discount Amount/Discount Over Weight: </span>
                                </div>
                                <div class="col-md-5 text-right style-padding-left ">
                                  <span class="Ws-bold-font">
                                      <app-span-label [value]="order.promotion?.code"></app-span-label> / {{order.promotion?.discountAmount | number}} <span>{{order.store_id | currencyStore}}</span>/{{order.promotion?.discountOverWeight}}g
                                  </span>
                                </div>
                              </div>

                              <hr>

                              <div class="row total_final_amount_local -discount">
                                <div class="col-md-7 style-padding-right dong">
                                  <span class="Ws-bold-font" i18n >Total value of orders (-discount)</span>
                                </div>
                                <div class="col-md-5 text-right style-padding-left total_final_amount_local">
                                  <span class="Ws-bold-font">
                                    {{order.total_final_amount_local | number}}
                                  </span>
                                  <span class="Ws-bold-font">{{order.store_id | currencyStore}}</span>
                                </div>
                              </div>

                              <hr>
                              <div class="row Paid">
                                <div class="col-md-6 text-success Ws-bold-font " i18n >Paid</div>
                                <div class="col-md-6 text-right text-success">
                                  {{order.total_paid_amount_local | number}} <span>{{order.store_id | currencyStore}}</span>
                                </div>
                              </div>
                              <div class="row Collect so-tien-thu-them Cod">
                                <div id="số tiền còn thiếu" class="col-md-6 text-info cod" i18n >Collect</div>
                                <div class="col-md-6 text-right text-info style-padding-left">{{order.total_final_amount_local > order.total_paid_amount_local ? getChangeAmount(order.total_final_amount_local,order.total_paid_amount_local) : 0 | number}} <span>{{order.store_id | currencyStore}}</span></div>
                              </div>
                              <div class="row Refund" *ngIf="order.total_refund_amount_local">
                                <div id="Số tiền thừa" class="col-md-6" i18n>Refund</div>
                                <div class="col-md-6 text-right style-padding-left">
                                  {{order.total_refund_amount_local | number}} <span>{{order.store_id | currencyStore}}</span>
                                </div>
                              </div>

                              <hr>

                              <div>
                                <div class="col-md-12 pl-0 mt-2 pb-2">
                                    <button type="button" *ngIf="!_scope.checkMarketing() && !_scope.checkMasterMarketing()" (click)="chatG(order.id, order.ordercode, order.current_status)" class="btn btn-secondary btn-sm mr-2 mb-2" data-target="#showChatGroup" data-toggle="modal" data-backdrop="static" data-keyboard="false" i18n>
                                      <i class="fa fa-comments" aria-hidden="true"></i>
                                     Chat Group WS
                                    </button>

                                  <div *ngIf="checkBuynow(order)" >
                                    <a *ngFor="let pro of order.products" href="{{getLinkBuynow(pro)}}"  class="btn btn-secondary btn-sm mr-2 mb-2 add-on" target="_blank" (click)="buyNow(order)" i18n>Buy Now</a>
                                  </div>

                                  <!--<button *ngIf="checkUpdatenow(order)" type="button" class="btn btn-secondary mr-2 mb-2 btn-sm" (click)="openUpdateOrder(order);updateOrder.show();">-->
                                    <!--<i class="fa fa-edit mr-1 " aria-hidden="true"></i> Update Order Purchase-->
                                  <!--</button>-->
                                  <button *ngIf="checkBuynow(order)" type="button" class="btn btn-secondary mb-2 mr-2 btn-sm" (click)="openUpdateOrder(order);purchaseCard.show();" i18n>
                                    <i class="fa fa-shopping-cart"></i> Purchase Buy Now
                                  </button>

                                </div>
                              </div>
                            </div>
                            <div class="col-md-3 border-col">
                              <div class="hover-row">
                                <div class="row STATUS">
                                  <div class="col-md-7">
                                    <h5 i18n>STATUS</h5>
                                  </div>
                                  <div class="col-md-5" style="text-align: right">
                                    <button class="btn btn-sm bg-white" tooltip="Show status" *ngIf="!statusShow[order.id]" (click)="statusShow[order.id] = !statusShow[order.id]" i18n>
                                      <i class="fa fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm bg-white" tooltip="Hide status" *ngIf="statusShow[order.id]" (click)="statusShow[order.id] = !statusShow[order.id]" i18n>
                                      <i class="fa fa-eye-slash"></i>
                                    </button>
                                  </div>
                                </div>
                              </div>
                              <div class="hover-row">
                                <div class="row">
                                  <div class="col-md-5 pr-0" i18n >New:</div>
                                  <div class="col-md-7 text-right {{order.new}}" *ngIf="order.new" >{{order.new | date:'dd/MM/yyyy HH:mm:ss '}}</div>
                                </div>
                                <div [hidden]="!statusShow[order.id]">
                                  <div class="row">
                                    <div class="col-md-5 pr-0" i18n >Supporting:</div>
                                    <!--<div class="col-md-7 text-right {{order.new}}" *ngIf="order.new" >{{order.new | date:'dd/MM/yyyy HH:mm:ss '}}</div>-->
                                  </div>
                                  <div class="row">
                                    <div class="col-md-5 pr-0" i18n >Supported:</div>
                                    <!--<div class="col-md-7 text-right {{order.new}}" *ngIf="order.new" >{{order.new | date:'dd/MM/yyyy HH:mm:ss '}}</div>-->
                                  </div>
                                  <div class="row">
                                    <div class="col-md-5 pr-0" i18n >Ready Purchase:</div>
                                    <!--<div class="col-md-7 text-right {{order.new}}" *ngIf="order.new" >{{order.new | date:'dd/MM/yyyy HH:mm:ss '}}</div>-->
                                  </div>
                                  <div class="row">
                                    <div class="col-md-6 pr-0" i18n>Purchase Start:</div>
                                    <div class="col-md-6 text-right" *ngIf="order.purchase_start">{{ order.purchase_start | date:'dd/MM/yyyy HH:mm:ss '}}</div>
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-md-6 pr-0" i18n>Purchased:</div>
                                  <div class="col-md-6 text-right" *ngIf="order.purchased">{{ order.purchased | date:'dd/MM/yyyy HH:mm:ss '}}</div>
                                </div>
                                <div class="row">
                                  <div class="col-md-6 pr-0" i18n>Seller shipped:</div>
                                  <div class="col-md-6 text-right" *ngIf="order.seller_shipped" >{{order.seller_shipped | date:'dd/MM/yyyy HH:mm'}}
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-md-6 pr-0" i18n>Stock in US:</div>
                                  <div class="col-md-6 text-right" *ngIf="order.stockin_us" >{{order.stockin_us | date:'dd/MM/yyyy HH:mm'}}</div>
                                </div>
                                <div class="row">
                                  <div class="col-md-6 pr-0" i18n>Stock out US:</div>
                                  <div class="col-md-6 text-right" *ngIf="order.stockout_us">{{order.stockout_us | date:'dd/MM/yyyy HH:mm'}}</div>
                                </div>
                                <div class="row">
                                  <div class="col-md-5  pr-0" i18n>Stock in local:</div>
                                  <div class="col-md-7 text-right" *ngIf="order.stockin_local">{{order.stockin_local | date:'dd/MM/yyyy HH:mm'}}
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-md-5  pr-0" i18n>Stock out local:</div>
                                  <div class="col-md-7 text-right" *ngIf="order.stockout_local">{{ order.stockout_local| date:'dd/MM/yyyy HH:mm'}}
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-md-5  pr-0" i18n>At customer:</div>
                                  <div class="col-md-7 text-right" *ngIf="order.at_customer">{{ order.at_customer | date:'dd/MM/yyyy HH:mm'}}
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-md-5  pr-0" i18n>Returned:</div>
                                  <div class="col-md-7 text-right" *ngIf="order.returned">{{ order.returned | date:'dd/MM/yyyy HH:mm'}}</div>
                                </div>
                                <div class="row">
                                  <div class="col-md-6  pr-0" i18n>Cancelled:</div>
                                  <div class="col-md-6 text-right" *ngIf="order.cancelled">{{order.cancelled | date:'dd/MM/yyyy HH:mm'}}</div>
                                </div>
                                <div class="row">
                                  <div class="col-md-5  pr-0" i18n>Lost:</div>
                                  <div class="col-md-7 text-right" *ngIf="order.lost">{{order.lost | date:'dd/MM/yyyy HH:mm'}}</div>
                                </div>
                              </div>
                              <div class="row m-t-10">
                                <div class="col-md-12 p-0 text-center">
                                  <div class="btn-group mr-2 mb-2">
                                    <button class="btn btn-sm btn-danger" *ngIf="checkCancel(order.current_status)" (click)="cancelOrder(order.id)" >
                                      <i class="fa fa-trash" aria-hidden="true"></i><span i18n>Cancel Order</span>
                                    </button>
                                    <div class="btn-group">
                                      <button   type="button" class="btn btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" i18n>
                                         Option
                                      </button>
                                      <div class="dropdown-menu style-d" style="font-size: 11px" >
                                        <a class="dropdown-item pt-1 pr-1 pb-1 sty-drop" *ngIf="(_scope.checkSuperAdmin() || _scope.checkTester()) && order.total_paid_amount_local > 0" id="Cập nhập coupon" href="javascript:void(0);" data-target="#showCoupon" data-toggle="modal" data-backdrop="static" (click)="updateCoupon(order)" data-keyboard="false" i18n><i class="fa fa-gift mr-2" aria-hidden="true"></i>Update Coupon</a>
                                        <a class="dropdown-item pt-1 pr-1 pb-1 sty-drop" *ngIf="(_scope.checkSuperAdmin() || _scope.checkTester()) && order.total_paid_amount_local > 0" id="Cập nhập khuyến mại SUP" href="javascript:void(0);" data-target="#showPromotion" data-toggle="modal" data-backdrop="static" (click)="updatePromotion(order)" data-keyboard="false" i18n><i class="fa fa-gift mr-2" aria-hidden="true"></i>Promotion updates</a>
                                        <a class="dropdown-item  pt-1 pr-1 pb-1 sty-drop " *ngIf="_scope.checkSuperAdmin() || _scope.checkTester()" id="Điều_chỉnh_tiền_thanh_toán SUP" href="javascript:void(0);" (click)="updateAdjustPayment(order)" data-target="#showAdjustPayment" data-toggle="modal" data-backdrop="static" data-keyboard="false" i18n><i class="fa fa-edit mr-2" aria-hidden="true"></i>Adjust payment</a>
                                        <a class="dropdown-item pt-1 pr-1 pb-1 sty-drop " *ngIf="_scope.checkRoleOption()" id="Trả_lại_tiền_do_Khiếu_Nại OPS" href="javascript:void(0);" (click)="openUpdatePayBack(order)" data-target="#showPayBack" data-toggle="modal" data-backdrop="static" data-keyboard="false" i18n><i class="fa fa-arrow-left mr-2" aria-hidden="true"></i>Pay back the Complaint</a>
                                        <a class="dropdown-item  pt-1 pr-1 pb-1 sty-drop" *ngIf="_scope.checkRoleOption()" id="Người bán Refund" href="javascript:void(0);" (click)="openSellerRefund(order)" data-target="#showSellerRefund" data-toggle="modal" data-backdrop="static" data-keyboard="false" i18n><i class="fa fa-reply-all mr-2" aria-hidden="true"></i>Seller Refund</a>
                                        <a class="dropdown-item  pt-1 pr-1 pb-1 sty-drop" *ngIf="_scope.checkRoleOption()" id="Đánh dấu chờ phản hồi từ shop" href="javascript:void(0);" data-target="#orderChatRefund" data-toggle="modal" data-backdrop="static" data-keyboard="false" (click)="openOrderChatRefund(order)" i18n><i class="fa fa-thumb-tack mr-2" aria-hidden="true"></i>Mark orders waiting for feedbacki</a>


                                        <a class="dropdown-item  pt-1 pr-1 pb-1 sty-drop" *ngIf="_scope.checkRoleOption()" title="Add syntax structure" id="" href="javascript:void(0);" data-target="#orderChatSupporting" (click) = "loadChatSupporting()" data-toggle="modal" data-backdrop="static" data-keyboard="false"><i class="fa fa-comment-alt mr-2" aria-hidden="true"></i><span i18n>Add syntax structure</span> --> SUPPORTING</a>        



                                        <a class="dropdown-item pt-1 pr-1 pb-1 sty-drop" *ngIf="_scope.checkRoleOption()" id="Đánh dấu đơn  chờ Refund OPS" href="javascript:void(0);" i18n><i class="fa fa-check-circle mr-2" aria-hidden="true" ></i>Mark the order waiting for Refund</a>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="btn-group">
                                    <button *ngIf="order.mark_supporting" class="btn btn-sm btn-default"><i class="fa fa-check mr-1"></i>{{order.mark_supporting | markSupporting}}</button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row pb-1 pt-1" style="margin-left: 1px">
                            <div class="col-md-12 pl-0 tab-slider--nav">
                              <ul class="tab-slider--tabs st-ul">
                                <li class="tab-slider--trigger" rel="tab1" (click)=" pro[order.id] = !pro[order.id]">
                                  <button class="btn btn-sm bg-white mr-2 style-but" i18n >Product</button>
                                </li>
                                <!--<li class="tab-slider&#45;&#45;trigger" [class.active]="viewMode == 'pro' + order.id" rel="tab2" (click)="viewMode ='pro' + order.id">-->
                                  <!--<button class="btn btn-sm bg-white mr-2 style-but" i18n>Product</button>-->
                                <!--</li>-->
                                <li class="tab-slider--trigger" rel="tab2" (click)="pack[order.id] = !pack[order.id]">
                                  <button class="btn btn-sm bg-white mr-2 style-but" i18n>Package Infor</button>
                                </li>
                                <li class="tab-slider--trigger" rel="tab2" (click)="pay[order.id] = !pay[order.id]">
                                  <button class="btn btn-sm bg-white mr-2 style-but" i18n >Payment Transaction</button>
                                </li>
                                <li class="tab-slider--trigger" rel="tab2" *ngIf="order.purchased" (click)="pur[order.id] = !pur[order.id];click_pur[order.id] = true">
                                  <button class="btn btn-sm bg-white mr-2 style-but" i18n >Purchase info</button>
                                </li>
                              </ul>
                            </div>
                            <div class="col-md-12 pl-0 mt-2 tab-slider--container">
                              <div id="tab3" class="tab-slider--body">
                                <app-wallet-transactions [hidden]="!pay[order.id]" [walletTransactions] = "order.walletTransactions"></app-wallet-transactions>
                              </div>
                              <div id="tab2" class="tab-slider--body">
                                <app-package-item [hidden]="!pack[order.id]" *ngIf="pack[order.id]" [orderIDD] = "order.id"  [orderCode] = "order.ordercode"></app-package-item>
                              </div>
                              <div id="tab" class="tab-slider--body">
                                <app-order-detail [hidden]="!pro[order.id]" [storeID] = "order.store_id" [Employee_Purchase]="order.purchaseAssignee ? order.purchaseAssignee.username : ''" (editFee)="listOrders()" [products]="order.products" ></app-order-detail>
                              </div>
                              <div id="tab4" class="tab-slider--body">
                                <app-purchase-info [hidden]="!pur[order.id]" [order_id]="order.id" [openClick]="click_pur[order.id]"></app-purchase-info>
                              </div>
                              <!--<div id="tab1" class="tab-slider&#45;&#45;body" *ngSwitchCase="'pro' + order.id">-->
                                <!--<app-order-detail (editFee)="listOrders()" [products]="order.products" ></app-order-detail>-->
                              <!--</div>-->
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--<div class="card-body" style="padding-left: 0; padding-right: 0">-->
                      <!--<h4 class="text-danger">Not Found</h4>-->
                      <!--</div>-->
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </article>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" bsModal #updateOrder="bs-modal" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content" style="width: 80em">
      <div class="modal-header ng-scope">
        <h3 class="modal-title">Order Infor : <span class="label label-warning">{{orderUpdatePurchase?.ordercode}}</span></h3>
        <button type="button" class="close" data-dismiss="modal">
          <a href="javascript:void(0)">
            <span aria-hidden="true" (click)="updateOrder.hide()">×</span>
          </a>
          <span class="sr-only" i18n>Close</span>
        </button>
      </div>
      <app-update-order *ngIf="orderUpdatePurchase" [orderUpdatePurchase] = "orderUpdatePurchase"></app-update-order>
    </div>
  </div>
</div>

<div id="showChat" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog modal-lg" style="background-color: #f5f5f5">
    <div class="modal-content">
      <div class="row">
        <div class="col-lg-12 p-0">
          <div class="card m-b-0">
            <div class="card-body">
              <div class="row">
                <div class="col-lg-12 p-0">
                  <div class="modal-body p-0">
                    <div class="ng-star-inserted">
                      <app-chat *ngIf="checkLoad" [id] = "orderIdChat"  [status]="statusO" [code]="code"></app-chat>
                    </div>
                  </div>
                </div>
                <div class="col-md-12 text-right mt-2">
                  <button class="btn btn-danger btn-sm" data-dismiss="modal" (click)="offModeChat()">Cancel</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="showChatGroup" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel1">
  <div class="modal-dialog modal-lg" style="background-color: #f5f5f5">
    <div class="modal-content">
      <div class="row">
        <div class="col-lg-12 p-0">
          <div class="card m-b-0">
            <div class="card-body">
              <div class="row">
                <div class="col-md-12 p-0">
                  <div class="modal-body p-0">
                    <div class="ng-star-inserted">
                      <app-chat-group *ngIf="checkLoadG" [id] = "orderIdChat" [status]="statusO" [code]="codeG"></app-chat-group>
                    </div>
                  </div>
                </div>
                <div class="col-md-12 mt-2 text-right">
                  <button class="btn btn-danger btn-sm" data-dismiss="modal" (click)="offModeChat()" i18n>Hủy Bỏ</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" bsModal #purchaseCard="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl" style="max-width: 95%;">
    <div class="modal-content">
      <app-purchase-card (closePopup)="purchaseCard.hide()" [clickBtn]="true" [updateProductId]="updateOrderPurchaseId"></app-purchase-card>
    </div>
  </div>
</div>

<div bsModal #ModalviewMoreLog="bs-modal" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog width-max" style="max-width: 95%;">
    <div class="modal-content">
      <div class="modal-body">
        <div class="card-body p-0">
          <div class="row">
            <div class="col-lg-12">

              <div class="modal-header p-0 pl-2 pr-2">

                <h2 class="modal-title" i18n>View Log - <strong class="text-uppercase text-danger">
                  Order-{{logIdOrder}}
                </strong>
                </h2>
                <!--<button class="btn btn-skype" i18n (click)="freshMoreLog(logIdOrder)">Refresh</button>-->
              </div>
              <div>
                <div class="modal-body">

                  <div class="container-fluid p-0 pl-2 pr-2 ng-star-inserted">
                    <div class="row btn-group">
                      <button class="active btn btn-{{typeViewLogs == 'action_logs' ? 'success' : 'default'}}" (click)="loadData('actionlog', logIdOrder); typeViewLogs = 'action_logs'">Action</button>
                      <button class="btn btn-{{typeViewLogs == 'wallet_logs' ? 'primary' : 'default'}}" (click)="loadData('walletlog', logIdOrder); typeViewLogs = 'wallet_logs'">Wallet</button>
                      <button class="btn btn-{{typeViewLogs == 'payment_logs' ? 'secondary' : 'default'}}" (click)="loadData('paymentlog', logIdOrder); typeViewLogs = 'payment_logs'">Payment</button>
                      <button class="btn btn-{{typeViewLogs == 'boxme' ? 'dark' : 'default'}}" (click)="loadData('boxme-inspect-log', logIdOrder); typeViewLogs = 'boxme'">Boxme Inspect</button>
                      <button class="btn btn-{{typeViewLogs == 'send-shipment-return-logs' ? 'warning' : 'default'}}" (click)="loadData('send-shipment-return-log', logIdOrder); typeViewLogs = 'send-shipment-return-logs'">Send Shipment Return</button>
                      <button class="btn btn-{{typeViewLogs == 'send-shipment-logs' ? 'success' : 'default'}}" (click)="loadData('send-shipment-log', logIdOrder); typeViewLogs = 'send-shipment-logs'">Send Shipment</button>
                    </div>
                    <hr>
                    <div class="row">
                      <table class="table table-bordered table-hover table_support_logs table-striped ng-star-inserted">
                        <thead>
                        <tr>
                          <th i18n>Create time</th>
                          <th i18n>Content</th>
                          <th i18n>Employee</th>
                          <th i18n>Role</th>
                        </tr>
                        </thead>
                        <tbody *ngIf="listLog.length > 0">
                        <tr *ngFor="let log of listLog">
                          <td>{{log.date}}td>{{log.dat                    <td>
                            <a href="javascript:void(0)"><i class="fa fa-eye" data-placement="right" [popover]="logDetail" popoverTitle="View detail log"></i></a><br>
                            <ng-template #logDetail style="max-width: 500px">
                              <strong>Data Input</strong><div [innerHTML]="log.data_input"></div>
                              <strong>Data Output</strong><div [innerHTML]="log.data_output"></div>
                            </ng-template>
                            {{log.action_path}}
                          </td>
                          <td>{{log.user_name}}</td>
                          <td>{{log.Role}}</td>
                        </tr>
                        </tbody>
                        <tbody *ngIf="listLog.length == 0">
                          <tr>
                            <td colspan="4" class="text-center">
                              <h3 class="text-danger" i18n>Not Found!</h3>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-sm btn-secondary pull-right" aria-label="Close"
                (click)="ModalviewMoreLog.hide();">Cancel
        </button>
        <button *ngIf="typeViewLogs == 'support_logs'" class="btn btn-sm btn-primary pull-right" aria-label="Save"
                (click)="saveLogSupport()" i18n >Save
        </button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" bsModal #updateReceiverModal="bs-modal" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title pull-left" i18n>Update</h4>
        <button type="button" (click)="updateReceiverModal.hide()" class="close" data-dismiss="modal" aria-hidden="true">×</button>
      </div>
      <div class="modal-body">
        <app-customer-information
                [orderId]="activeOrder.id"
                [name]="activeOrder.receiver_name"
                [phone]="activeOrder.receiver_phone"
                [email]="activeOrder.receiver_email"
                [address]="activeOrder.receiver_address"
                [district]="activeOrder.receiver_district_id"
                [districtName]="activeOrder.receiver_district_name"
                [province]="activeOrder.receiver_province_id"
                [provinceName]="activeOrder.receiver_province_name"
                [country]="activeOrder.receiver_country_id"
                [countryName]="activeOrder.receiver_country_name"
                [postCode]="activeOrder.receiver_post_code"
                (success)="updateReceiverModal.hide();listOrders()">
        </app-customer-information>
        <h3 *ngIf="!activeOrder">Failed</h3>
      </div>
    </div>

  </div>
</div>

<div id="showCoupon" class="modal fade" data-target="#myModal" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog modal-lg" style="background-color: #f5f5f5">
    <div class="modal-content">
      <div class="modal-header bg-success ng-scope">
        <h3 class="modal-title text-white" i18n >Update Coupon: <span class="label label-primary ng-binding">{{code}}</span></h3>
        <button type="button" class="close" data-dismiss="modal" (click)="offOption()">
          <span class="text-white" aria-hidden="true">×</span>
          <span class="sr-only" i18n >close</span>
        </button>
      </div>
      <app-update-coupon (checkEdit)="handleChangeAmount($event)" (checkOffC)="handCheckPromotion($event)" *ngIf="checkOpenCoupon" [id] = "orderID" [store_id] = "store_id" [coupon_id]="coupon_id"  [ordercode] = "code"></app-update-coupon>
    </div>
  </div>
</div>
<div id="showPromotion" class="modal fade" data-target="#myModal" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog modal-lg" style="background-color: #f5f5f5">
    <div class="modal-content">
      <div class="modal-header bg-success ng-scope">
        <h3 class="modal-title text-white" i18n >Update Promotion: <span class="label label-primary ng-binding">{{code}}</span></h3>
        <button type="button" class="close" data-dismiss="modal" (click)="offOption()">
          <span class="text-white" aria-hidden="true">×</span>
          <span class="sr-only" i18n >close</span>
        </button>
      </div>
      <app-update-promotion (checkEdit)="handleChangeAmount($event)" (checkOff)="handCheckPromotion($event)" *ngIf="checkOpenPromotion" [id] = "orderID" [store_id] = "store_id" [promotion_id]="promotion_id" [ordercode] = "code"></app-update-promotion>
    </div>
  </div>
</div>


<div id="showAdjustPayment" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog modal-lg" style="background-color: #f5f5f5">
    <div class="modal-content">
      <div class="modal-header bg-success ng-scope">
        <h3 class="modal-title text-white" i18n>Update Order Ad Just Payment: <span class="label label-primary ng-binding">{{code}}</span></h3>
        <button type="button" class="close" data-dismiss="modal" (click)="offOption()">
          <span class="text-white" aria-hidden="true">×</span>
          <span class="sr-only" i18n>Close</span>
        </button>
      </div>
      <form [formGroup] = "editForm" *ngIf="checkOpenAdJustPayment == true">
        <div class="modal-body ng-scope">
          <div style="border: 1px solid #d9d9d9">
            <div class="row m-0">
              <div class="col-md-12 pt-2 pb-2" style="background-color: #AFEEEE">
                <span i18n>Please enter the payment amount</span>
              </div>
            </div>
            <div class="row m-0 mt-3">
              <div class="col-md-6">
                <label i18n >Total Paid Amount Local</label>
                <input type="number" class="form-control form-control-sm" formControlName="total_paid_amount_local">
                <label style="font-size: 2em; color: red">Price :
                  <span *ngIf="store_id === 1">{{this.editForm.get('total_paid_amount_local').value | number}}{{store_id | currencyStore}}</span>
                  <!--<span *ngIf="store_id !== 1">{{this.editForm.get('total_paid_amount_local').value | currency:'USD'}}</span>-->
                </label>
              </div>
            </div>
            <div class="row m-0">
              <div class="col-md-12 pt-2 pb-2" style="background-color: #FFE4B5" i18n>
                Note: Staff carefully check <span class="text-danger">orders</span> and enter exact <span class="text-danger">prices</span>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer ng-scope">
          <button class="btn btn-success btn-sm" type="button" (click)="confirmAdjustPayment()" i18n>Confirm</button>
          <button class="btn btn-danger btn-sm" type="button" (click)="offOption()" data-dismiss="modal" i18n>Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div id="showPayBack" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog modal-lg" style="background-color: #f5f5f5">
    <div class="modal-content">
      <div class="modal-header ng-scope bg-success">
        <h3 class="modal-title text-white" i18n>Update Order Pay back the Complaint : <span class="label label-primary ng-binding">{{code}}</span></h3>
        <button type="button" class="close" data-dismiss="modal" (click)="offOption()">
          <span class="text-white" aria-hidden="true">×</span>
          <span class="sr-only" i18n >Close</span>
        </button>
      </div>
      <form [formGroup] = "editForm" *ngIf="checkOpenPayBack == true">
        <div class="modal-body ng-scope">
          <div style="border: 1px solid #d9d9d9">
            <div class="row m-0">
              <div class="col-md-12 pt-2 pb-2" style="background-color: #AFEEEE">
                <span i18n>Please enter the customer return amount</span>
              </div>
            </div>
            <div class="row m-0 mt-3">
              <div class="col-md-6">
                <label i18n >Total refund Amount Local</label>
                <input type="number" class="form-control form-control-sm" formControlName="total_refund_amount_local">
                <label style="font-size: 2em; color: red" ><span>Price : </span>
                  <span *ngIf="store_id === 1">{{this.editForm.get('total_refund_amount_local').value | number}}{{store_id | currencyStore}}</span>
                  <span *ngIf="store_id !== 1">{{this.editForm.get('total_refund_amount_local').value | number}}{{store_id | currencyStore}}</span>
                </label>
              </div>
            </div>
            <div class="row m-0">
              <div class="col-md-12 pt-2 pb-2" style="background-color: #FFE4B5" i18n>
                Note: Staff carefully check <span class="text-danger">orders</span> and enter exact <span class="text-danger">prices</span>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer ng-scope">
          <button class="btn btn-success btn-sm" type="button" (click)="updatePayBack()" i18n>Confirm</button>
          <button class="btn btn-danger btn-sm" type="button" (click)="offOption()" data-dismiss="modal" i18n>Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div id="showSellerRefund" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog modal-lg" style="background-color: #f5f5f5">
    <div class="modal-content">
      <div class="modal-header ng-scope bg-success">
        <h3 class="modal-title text-white" i18n>Update Order Seller Refund : <span class="label label-primary ng-binding">{{code}}</span></h3>
        <button type="button" class="close" data-dismiss="modal" (click)="offOption()">
          <span class="text-white" aria-hidden="true">×</span>
          <span class="sr-only" i18n>Close</span>
        </button>
      </div>
      <form [formGroup] = "editForm" *ngIf="checkSellerRefund == true">
        <div class="modal-body ng-scope">
          <div style="border: 1px solid #d9d9d9">
            <div class="row m-0">
              <div class="col-md-12 pt-2 pb-2" style="background-color: #AFEEEE">
                <span i18n>Please enter the seller's refund amount</span>
              </div>
            </div>
            <div class="row m-0 mt-3">
              <div class="col-md-6">
                <label i18n>Purchase Amount Refund</label>
                <input type="text" class="form-control form-control-sm" formControlName="purchase_amount_refund">
                <label style="font-size: 2em; color: red">Price :
                  <span *ngIf="store_id === 1">{{this.editForm.get('purchase_amount_refund').value | number}}{{store_id | currencyStore}}</span>
                  <span *ngIf="store_id !== 1">{{this.editForm.get('purchase_amount_refund').value | number}}{{store_id | currencyStore}}</span>
                </label>
              </div>
              <div class="col-md-6">
                <label i18n>Purchase Amount Buck</label>
                <input type="number" class="form-control form-control-sm" formControlName="purchase_amount_buck">
              </div>
            </div>
            <div class="row m-0">
              <div class="col-md-12 pt-2 pb-2" style="background-color: #FFE4B5" i18n>
                Note: Staff carefully check <span class="text-danger">orders</span> and enter exact <span class="text-danger">prices</span>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer ng-scope">
          <button class="btn btn-success btn-sm" type="button" (click)="updateSellerRefund()" i18n>Confirm</button>
          <button class="btn btn-danger btn-sm" type="button" (click)="offOption()" data-dismiss="modal" i18n>Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div id="orderChatRefund" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog modal-lg" style="background-color: #f5f5f5">
    <div class="modal-content" uib-modal-transclude="">
      <div class="modal-header ng-scope bg-success">
        <h3 class="modal-title text-white">Mark waiting for feedback from the seller : <span class="label label-primary ng-binding">{{code}}</span></h3>
        <button type="button" class="close" data-dismiss="modal" (click)="offOption()">
          <span class="text-white" aria-hidden="true">×</span>
          <span class="sr-only" i18n>Close</span>
        </button>
      </div>
      <div class="modal-body ng-scope" *ngIf="checkOrderChatRefund">
        <form [formGroup] = "editForm">
          <div class="row m-0">
            <div class="col-md-12 pt-2 pb-2" style="background-color: #AFEEEE">
              <span i18n>Please confirm the information below:</span>
            </div>
          </div>
          <div class="row row mt-2 pl-3">
            <div class="col-md-8 mt-1">
              <label>
                <input type="radio"  name="wait" formControlName="wait1" value="1"><span i18n>Wait to bargain</span></label>
            </div>
            <div class="col-md-8 mt-1">
              <label>
                <input type="radio" name="wait" formControlName="wait2" value="2"> <span i18n>Waiting for customers to respond</span>
              </label>
            </div>
            <div class="col-md-8 mt-1">
              <label>
                <input type="radio"  name="wait" formControlName="wait3" value="3"> <span i18n>Wait for the seller to answer.</span>
              </label>
              <div class="form-group mt-1" style="margin-left: 3px;">
                <div class="col-md-12">
                  <label class="text-danger" i18n>Link to exchange photos with Shop</label>
                  <input type="text" class="form-control ng-pristine ng-untouched ng-valid ng-empty mt-1" formControlName="link_image"  name="screenshot_chat_shop" placeholder="link image" i18n-placeholder>
                </div>
              </div>
            </div>
          </div>
          <div class="alert alert-warning row" role="alert">
            <div class="card-body">
              <div class="input-group">
              <textarea name="" class="form-control type_msg" rows="4" formControlName="message"
                        placeholder="Enter the exchange content.
                        Press Shift + Enter to get down the line.
                        Enter to send" i18n-placeholder>
              </textarea>
                <div class="input-group-btn">
                  <button style="height: 80px;" class="btn btn-default" i18n>Sent</button>
                </div>
              </div>
            </div>
          </div>
        </form>

      </div>
      <div class="modal-footer ng-scope">
        <button class="btn btn-success btn-sm" type="button" (click)="updateMarkWaiting()">Approve</button>
        <button class="btn btn-warning btn-sm" type="button" data-dismiss="modal" (click)="offOption()">Close</button>
      </div>
    </div>
  </div>
</div>

<div id="orderChatSupporting" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog modal-lg" style="background-color: #f5f5f5">
    <div class="modal-content" uib-modal-transclude="">
      <div class="modal-header ng-scope bg-success">
        <h3 class="modal-title text-white"><span i18n>Add syntax structure </span></h3>
        <button type="button" class="close" data-dismiss="modal" (click)="offOption()">
          <span class="text-white" aria-hidden="true">×</span>
          <span class="sr-only" i18n>Close</span>
        </button>
      </div>
      <div class="modal-body ng-scope">
          <!-- Tab panes -->
        <form action="" [formGroup] = "chatSupporting">
          <div class="alert row" role="alert">
            <textarea class="form-control ng-pristine ng-untouched ng-valid ng-empty" id="msg_orderchatsupporting" formControlName="messageSupporting" (keydown.enter)="createChatSupporting()" rows="4" placeholder="Please enter..." i18n-placeholder></textarea>
          </div>
        </form>
        <div class="content-listchat-supporting">
          <table class="table">
            <thead>
            <tr>
              <th scope="col">STT</th>
              <th scope="col"><span i18n>Content</span></th>
              <th scope="col">...</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor = 'let chat of chatlists;let i = index'>
              <td>{{i+1}}</td>
              <td>
                {{chat}}
              </td>
              <td>
                <a class="delete-chatsupporting" (click) = "deleteChatSupporting(i)">
                  <i class="fa fa-trash"></i>
                </a>
              </td>
            </tr>


            </tbody>
          </table>

        </div>
      </div>
      </div>
      <div class="modal-footer ng-scope">
        <button class="btn btn-warning btn-sm" type="button"  data-dismiss="modal" (click)="offOption()">Close</button>
      </div>
    </div>
</div>
